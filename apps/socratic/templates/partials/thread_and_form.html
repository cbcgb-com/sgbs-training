<div class="flex flex-col flex-1 min-h-0">
    <div class="flex-1 overflow-auto pb-4">
        {% for msg in messages %}
        <div class="mb-4 {% if msg.role == 'assistant' %}bg-blue-50 border-l-4 border-blue-400 pl-4 py-2 rounded-r{% else %}bg-gray-100 pl-4 py-2 rounded{% endif %}">
            <p class="text-xs font-medium text-gray-500 mb-1">{% if msg.role == 'assistant' %}Coach{% else %}You{% endif %}</p>
            <p class="whitespace-pre-wrap">{{ msg.content }}</p>
        </div>
        {% endfor %}
    </div>
    <div class="shrink-0 border-t border-gray-200 bg-gray-50 pt-4 pb-2">
        <form
            hx-post="/reply"
            hx-target="#conversation"
            hx-swap="innerHTML"
            hx-indicator="#form-spinner"
        >
            <input type="hidden" name="messages_encoded" value="{{ messages_encoded }}">
            <input type="hidden" name="coach_lang" id="coach_lang_input" value="simplified">
            <label for="user_message" class="block text-sm font-medium text-gray-700 mb-1">Your response</label>
            <textarea
                id="user_message"
                name="user_message"
                rows="3"
                class="w-full border border-gray-300 rounded-md px-3 py-2 text-gray-900 placeholder-gray-500 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 bg-white"
                placeholder="Type your thoughts..."
                required
            ></textarea>
            <div class="mt-2 flex items-center gap-2">
                <button
                    type="submit"
                    class="px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500"
                >
                    Send
                </button>
                <span id="form-spinner" class="htmx-indicator text-sm text-gray-500">Thinking...</span>
            </div>
        </form>
    </div>
</div>
